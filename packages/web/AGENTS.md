# Ocsight Web Project - KISS Rules

## Core Principles

### Keep It Simple, Stupid

- Build few high-impact tools that match natural workflows
- Return only high-signal context, optimize for token efficiency
- More tools ≠ better outcomes
- Design for agents, not humans

### Project Structure

- `src/content/docs/` - Documentation pages (Markdown/MDX/Markdoc)
- `src/components/` - Reusable Astro components
- `src/styles/` - CSS and Tailwind styles
- `src/pages/` - Custom Astro pages (rarely needed)
- `public/` - Static assets
- `src/content.config.ts` - Content collections configuration
- `astro.config.mjs` - Astro configuration with Starlight integration

## Content Rules

### File Format & Structure

- Use `.mdx` for documentation pages (preferred over `.md`)
- Support for `.mdoc` (Markdoc) files available
- Frontmatter must include `title` (required)
- Use `description` for SEO and previews
- Structure content with H2+ headings (H1 is page title)
- Link using relative paths: `/docs/getting-started/installation`

### Frontmatter Best Practices

```yaml
---
title: Page Title
description: Brief description for SEO
template: splash # Optional: for landing pages
sidebar:
  label: Custom Sidebar Label
  order: 2
  badge:
    text: New
    variant: tip
---
```

### Content Organization

- Group related content in subdirectories
- Use `index.mdx` for section landing pages
- Keep file names short and descriptive
- Follow existing naming conventions
- Files starting with underscore (`_`) are ignored

## Starlight-Specific Rules

### Configuration

- Configure sidebar in `astro.config.mjs` using `starlight.sidebar`
- Use autogenerate for directory-based navigation: `{ label: 'Section', autogenerate: { directory: 'section' } }`
- Enable sitemap by setting `site` URL in `astro.config.mjs`
- Configure table of contents globally or per page
- Use Expressive Code for enhanced code blocks

### Components

- Import Starlight components: `import { Card, Tabs } from '@astrojs/starlight/components'`
- Use built-in components for consistency: Cards, Tabs, Asides, Badges, etc.
- Override components minimally via `components` config
- Use `not-content` class to disable Starlight styling on custom components

### Styling

- Use custom CSS via `customCss` array in config
- Leverage CSS custom properties for theming
- Use Tailwind CSS with `@astrojs/starlight-tailwind` package
- Configure cascade layers properly: `@layer base, starlight, theme, components, utilities`

### Navigation

- Configure sidebar with groups, links, and autogenerated sections
- Use badges for status indicators: `badge: { text: 'New', variant: 'tip' }`
- Support internationalization with `translations` property
- Use collapsed groups for better organization: `collapsed: true`

## Component Rules

### Code Standards

- Single word variable names where possible
- Avoid unnecessary destructuring
- No `else` statements unless necessary
- No `try/catch` if avoidable
- No `any` types
- Prefer `const` over `let`
- Use Bun APIs when available

### Component Development

- Use `ComponentProps` type for prop typing
- Design for both MDX and Markdoc compatibility
- Test components in isolation
- Keep components focused and reusable

## Content Creation

### Writing Guidelines

- Write self-documenting code through clear naming
- Brutal simplicity over complexity
- No auto-generated comments or symbol-based documentation
- Focus on functionality over decoration
- Use Expressive Code features for code highlighting

### Markdown Features

- Use aside components: `:::note`, `:::tip`, `:::caution`, `:::danger`
- Leverage automatic heading anchor links
- Use `<details>` and `<summary>` for collapsible content
- Structure with proper heading hierarchy (H2, H3 for TOC)

## Performance Rules

### Build Optimization

- Enable compression and optimization
- Use manual chunks for vendor code
- Inline critical stylesheets
- Optimize images with Sharp service
- Use standalone mode for production
- Enable HTML compression
- Generate sitemaps automatically

### Development

- Test tools with real agent tasks before shipping
- Write clear tool descriptions for new hires
- Provide error guidance that tells agents how to fix
- Build evaluation-driven features

## Advanced Features

### Internationalization

- Configure locales in `astro.config.mjs`
- Use root locale for default language
- Support RTL languages with `dir: 'rtl'`
- Translate UI elements via `src/content/i18n/`

### Customization

- Override components via `components` config
- Use custom fonts with `@font-face` or Fontsource
- Configure Expressive Code for custom code styling
- Add custom CSS via cascade layers

### Search & Discovery

- Pagefind search enabled by default
- Configure search ranking via `pagefind.ranking`
- Support multisite search with `pagefind.mergeIndex`
- Disable search with `pagefind: false`

## File Organization Best Practices

### Directory Structure

```
src/
├── content/
│   ├── docs/           # Documentation content
│   │   ├── guides/     # Grouped content
│   │   ├── reference/  # API/docs reference
│   │   └── index.mdx   # Homepage
│   └── i18n/          # Translation files
├── components/        # Custom components
├── styles/           # Custom CSS
└── pages/           # Custom pages (rare)
```

### Naming Conventions

- Use kebab-case for files and directories
- Use PascalCase for components
- Keep names descriptive but concise
- Follow existing patterns in the codebase

## New Enhanced Features

### Enhanced Code Experience

- **Code Component**: Advanced code blocks with copy buttons, line numbers, syntax highlighting
- **Copy Functionality**: One-click code copying with visual feedback
- **Line Highlighting**: Support for highlighting specific lines in code blocks
- **Collapsible Code**: Expandable/collapsible code sections with titles

### Interactive Components

- **Session Sharing**: Generate shareable session links with OG images
- **Social Sharing**: Twitter, LinkedIn, and copy link buttons for content sharing
- **Enhanced CLI Simulator**: Interactive command-line interface with session persistence

### Advanced Content Organization

- **Sidebar Badges**: Visual indicators for content status (New, Updated, Interactive, etc.)
- **Collapsible Groups**: Organized sidebar sections with expand/collapse functionality
- **Autogenerate Sections**: Automatic sidebar generation for content directories
- **Enhanced Navigation**: Better visual hierarchy and navigation indicators

### Social & SEO Features

- **OG Image Generation**: Dynamic social media image generation for sharing
- **Enhanced Meta Tags**: Improved SEO with structured data and proper metadata
- **Social Sharing**: Integrated sharing buttons for major social platforms
- **Search Integration**: Pagefind-powered search with better indexing and results

### Accessibility Enhancements

- **Keyboard Navigation**: Full keyboard accessibility for all interactive elements
- **Screen Reader Support**: Proper ARIA labels and semantic HTML structure
- **Focus Management**: Visible focus indicators and logical tab order
- **Reduced Motion**: Respect for user's motion preferences

## Implementation Notes

### Technical Stack

- **Framework**: Astro 5.0 with Starlight 0.35.3 documentation framework
- **Styling**: Brutalist design system with Tailwind CSS integration
- **Components**: Astro components with React integration where needed
- **Build**: Node.js adapter with standalone mode for production
- **Performance**: Manual chunking, compression, and image optimization

### Key Dependencies

- `@astrojs/starlight`: Documentation framework
- `@astrojs/tailwind`: Tailwind CSS integration
- `@astrojs/react`: React component support
- `sharp`: Image optimization
- `astro-compress`: Build compression
- Pagefind: Search functionality (built into Starlight)

### Component Architecture

- **Base Components**: Reusable layout and UI components in `src/components/base/`
- **Feature Components**: Specific functionality components in `src/components/`
- **Enhanced Code**: Advanced code block component with copy and highlighting
- **Social Sharing**: Platform-agnostic sharing component
- **Session Sharing**: Collaborative session management component

### Performance Considerations

- **Bundle Splitting**: Manual chunks for vendor, UI, and feature code
- **Lazy Loading**: Components load only when needed
- **Image Optimization**: Automatic optimization with Sharp
- **Compression**: CSS, JS, and HTML compression for production
- **Caching**: Proper cache headers for static assets

## Deployment

### Build Process

1. **Type Checking**: Astro type checking for TypeScript safety
2. **Content Validation**: MDX content validation and processing
3. **Asset Optimization**: Image compression and bundling
4. **Code Splitting**: Intelligent chunking for optimal loading
5. **Compression**: Final asset compression for production

### Environment Support

- **Development**: Hot reload with Astro dev server
- **Production**: Node.js standalone server mode
- **Static**: Static site generation support where applicable
- **Edge**: Compatible with edge deployment platforms

## IMPORTANT

- Try to keep things in one function unless composable or reusable
- DO NOT do unnecessary destructuring of variables
- DO NOT use `else` statements unless necessary
- DO NOT use `try`/`catch` if it can be avoided
- AVOID `try`/`catch` where possible
- AVOID `else` statements
- AVOID using `any` type
- AVOID `let` statements
- PREFER single word variable names where possible
- Use as many bun apis as possible like Bun.file()

## PROJECT RULE

Tools must be designed for agents, not humans. Build few high-impact tools that match natural workflows, return only high-signal context, and optimize for token efficiency. More tools ≠ better outcomes.

## OPENCODE INTEGRATION

Plugins hook into OpenCode events using TypeScript modules in `.opencode/plugin` directory. Export async functions that receive context ({ project, client, $, directory, worktree }) and return hooks for events like "session.created", "tool.execute.after", etc.

## TOOL DESIGN PRINCIPLES

- Build evaluation-driven: test tools with real agent tasks before shipping
- Clear tool descriptions: write for a new hire, not an expert
- High-signal responses: return only what agents need, not everything
- Token efficiency: use pagination, filtering, truncation with defaults
- Error guidance: errors must tell agents how to fix, not just fail
- Natural workflows: tools should match how humans solve problems
- Response formats: use enums for concise/detailed output options
- Namespacing: group related tools with clear prefixes

## PLUGIN BEST PRACTICES

- Type safety: use TypeScript types from @opencode-ai/plugin
- Context awareness: leverage project, client, $ shell, directory, worktree
- Event-driven: hook into lifecycle events, don't poll
- Error handling: throw meaningful errors that guide agents
- Minimal state: avoid complex state management in plugins
- Performance: tools should be fast, agents are impatient

## UI DESIGN RULE

- Clean, minimal brutalist design inspired by opencode.ai and shadcn/ui
- Simple color schemes with lots of white space and clear typography
- Focus on functionality over decoration - no unnecessary visual elements
- Geometric simplicity with structured layouts and content-first approach
- High-signal, low-noise interfaces that prioritize clarity and usability

## RECENT UPGRADES (v0.7.13)

### Enhanced Code Experience

- Replaced basic shiki with advanced code highlighting system
- Added copy-to-clipboard functionality on all code blocks
- Implemented line numbers and syntax highlighting improvements
- Added collapsible code sections with titles

### Advanced Content Organization

- Enhanced sidebar with badges (New, Updated, Interactive, etc.)
- Implemented collapsible navigation groups
- Added autogenerate sections for large content areas
- Improved visual hierarchy and navigation indicators

### Interactive & Social Features

- Created session sharing functionality with OG image generation
- Added social sharing buttons (Twitter, LinkedIn, Copy Link)
- Implemented enhanced CLI simulator with session persistence
- Added keyboard navigation and accessibility improvements

### Performance & SEO

- Integrated Pagefind search for better discovery
- Added OG image generation for social media sharing
- Enhanced meta tags and structured data for SEO
- Maintained existing performance optimizations

### Component Enhancements

- Created reusable Code component with advanced features
- Built SocialShare component for platform-agnostic sharing
- Developed SessionShare component for collaborative features
- Enhanced existing components with better accessibility
